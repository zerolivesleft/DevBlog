---
import { getCollection } from 'astro:content';
import BaseHead from '../../components/BaseHead.astro';
import Footer from '../../components/Footer.astro';
import FormattedDate from '../../components/FormattedDate.astro';
import Header from '../../components/Header.astro';
import { SITE_DESCRIPTION, SITE_TITLE } from '../../consts';

const posts = (await getCollection('blog')).sort(
	(a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
);
---

<!doctype html>
<html lang="en">
	<head>
		<BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
	</head>
	<body class="bg-zinc-950 text-zinc-100 flex flex-col min-h-screen font-mono">
		<Header />
		<main class="w-full max-w-4xl mx-auto px-4 py-12 flex-grow">
			<section>
				<div class="mb-8 flex items-center gap-2 text-zinc-500 border-b border-zinc-800 pb-2">
                    <span class="text-blue-500">$</span> ls -l ./posts
                </div>
				<ul class="space-y-2">
					{
						posts.map((post) => (
							<li class="group">
								<a href={`/blog/${post.id}/`} class="flex flex-col md:flex-row md:items-center gap-2 md:gap-4 p-2 -mx-2 rounded hover:bg-zinc-900 transition-colors">
                                    <div class="font-mono text-zinc-500 text-sm whitespace-nowrap">
                                        <span class="hidden md:inline text-zinc-600">-rw-r--r-- 1 user</span>
                                        <span class="ml-2 w-24 inline-block"><FormattedDate date={post.data.pubDate} /></span>
                                    </div>
									<div class="flex-grow">
                                        <span class="text-blue-500 font-bold opacity-0 group-hover:opacity-100 transition-opacity mr-2 hidden md:inline-block">></span>
										<span class="text-zinc-300 group-hover:text-blue-400 transition-colors font-medium">
                                            {post.data.title}
                                        </span>
                                        <span class="text-zinc-600 text-sm ml-2 hidden md:inline-block opacity-0 group-hover:opacity-100 transition-opacity">
                                            --read
                                        </span>
									</div>
								</a>
							</li>
						))
					}
				</ul>
                <div class="mt-4 text-zinc-500 animate-pulse">
                    <span class="text-blue-500">$</span> <span class="inline-block w-2 h-4 bg-zinc-500 align-middle"></span>
                </div>
			</section>
		</main>
		<Footer />
	</body>
</html>
